<!--pages/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="top-bar">
    <view class="title">å›¾ç‰‡æ‹–æ‹½</view>
    <view class="group-btn" bindtap="showGroupModal">
      <text class="group-icon">ğŸ“</text>
      <text class="group-text">åˆ†ç»„ç®¡ç†</text>
    </view>
  </view>

  <!-- textarea -->
  <textarea placeholder="è¯·è¾“å…¥ç‚¹ä»€ä¹ˆ" placeholder-class="placeholder-class"></textarea>

  <!-- åˆ†ç»„tabåˆ‡æ¢ -->
  <view class="group-tabs">
    <scroll-view scroll-x="true" class="tabs-scroll">
      <view class="tab-item {{currentGroupId === item.id ? 'active' : ''}}" wx:for="{{groups}}" wx:key="id" bindtap="switchGroup" data-group-id="{{item.id}}">
        <view class="tab-color" style="background-color: {{item.color}}"></view>
        <text class="tab-name">{{item.name}}</text>
      </view>
    </scroll-view>
  </view>

  <view class="image-drag-container">
    <movable-area class="movable-area" style="min-height:{{imageWitdh}}px;height:{{areaHeight}}px">
      <view class="image-choose-container">
        <view class="image-item" style="width:{{imageWitdh}}px;height:{{imageWitdh}}px" wx:for="{{images}}" wx:for-item="url" wx:key="url" data-url="{{url}}" data-index="{{index}}" bindlongpress='handleLongTap' bindtouchend='handleTouchEnd' catchtouchmove='handleTouchMove' >
        <image src="{{url}}" mode="aspectFill" bindtap="handlePreview" data-index="{{index}}" data-url="{{url}}"></image>
        <view class="close" bindtap="handleDelete" data-index="{{index}}">X</view>
      </view>
      <view class="add-button" style="width:{{imageWitdh}}px;height:{{imageWitdh}}px" wx:if="{{images.length >= 0 &&images.length < 9}}" bindtap="handleChooseImage">+</view>
       <view style="width:{{imageWitdh}}px" class="image-item image-item-temp" wx:if="{{images.length%3==1}}"></view>
      </view>
      <movable-view class="movable-view" style="width:{{imageWitdh}}px;height:{{imageWitdh}}px" hidden="{{hidden}}" x="{{x}}" y="{{y}}"  direction="all" damping="{{5000}}" friction="{{1}}">
        <image src="{{currentImg}}" wx:if="{{currentImg.length>0}}"></image>
      </movable-view>
    </movable-area>
  </view>
  <button>å‘å¸ƒ</button>
</view>

<!-- åˆ†ç»„ç®¡ç†å¼¹çª— -->
<view class="group-modal" wx:if="{{showGroupModal}}">
  <view class="modal-overlay" bindtap="hideGroupModal"></view>
  <view class="modal-content">
    <view class="modal-title">æ·»åŠ åˆ†ç»„</view>

    <view class="form-item">
      <text class="label">åˆ†ç»„åç§°</text>
      <input class="input" placeholder="è¯·è¾“å…¥åˆ†ç»„åç§°" value="{{newGroupName}}" bindinput="onGroupNameInput" />
    </view>

    <view class="form-item">
      <text class="label">åˆ†ç»„é¢œè‰²</text>
      <view class="color-picker">
        <view class="color-option" wx:for="{{presetColors}}" wx:key="value">
          <view class="color-dot" style="background-color: {{item.value}}" bindtap="selectColor" data-color="{{item.value}}"></view>
          <text class="color-name" wx:if="{{item.name}}">{{item.name}}</text>
        </view>
      </view>
      <view class="selected-color">
        <text>å·²é€‰é¢œè‰²:</text>
        <view class="selected-color-dot" style="background-color: {{selectedColor}}"></view>
      </view>
    </view>

    <view class="modal-actions">
      <button class="action-btn cancel-btn" bindtap="hideGroupModal">å–æ¶ˆ</button>
      <button class="action-btn confirm-btn" bindtap="confirmAddGroup">ç¡®è®¤</button>
    </view>
  </view>
</view>
